<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <!-- Content Security Policy - Secure configuration -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' ws://localhost:8765 ws://localhost:8001 ws://localhost:11434 http://localhost:11434 http://127.0.0.1:11434 https://api.elevenlabs.io https://api.openai.com; media-src 'self' blob:; object-src 'none'; base-uri 'self'; form-action 'self';" />
    <title>Heilion</title>
    <!-- Development CSP override script -->
    <script src="%PUBLIC_URL%/csp-dev.js"></script>
  </head>
  <body style="margin: 0; padding: 0; background: #000000;">
    <noscript>You need to enable JavaScript to run this app.</noscript>
    
    <!-- Splash Screen - Shows immediately -->
    <div id="splash-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000000; display: flex; align-items: center; justify-content: center; flex-direction: column; z-index: 9999;">
      <div style="color: #ffffff; font-size: 48px; font-weight: bold; margin-bottom: 20px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">Heilion</div>
      <div style="color: #888888; font-size: 16px; margin-bottom: 40px;">AI-Powered Study Tutor</div>
      <div style="width: 200px; height: 4px; background: #333333; border-radius: 2px; overflow: hidden;">
        <div id="splash-progress" style="width: 0%; height: 100%; background: linear-gradient(90deg, #0066ff, #00ccff); border-radius: 2px; transition: width 0.3s ease;"></div>
      </div>
      <div id="splash-status" style="color: #666666; font-size: 14px; margin-top: 20px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">Loading...</div>
    </div>
    
    <div id="root"></div>
    
    <script>
      // Splash screen management
      let splashProgress = 0;
      const splashInterval = setInterval(function() {
        splashProgress += 10;
        const progressBar = document.getElementById('splash-progress');
        const statusText = document.getElementById('splash-status');
        if (progressBar) progressBar.style.width = splashProgress + '%';
        
        if (splashProgress >= 100) {
          splashProgress = 0; // Reset and continue
          if (statusText) {
            statusText.textContent = 'Initializing...';
          }
        }
      }, 200);
      
      // Hide splash when React is ready
      window.hideSplashScreen = function() {
        const splash = document.getElementById('splash-screen');
        if (splash) {
          splash.style.opacity = '0';
          splash.style.transition = 'opacity 0.5s ease';
          setTimeout(function() {
            splash.style.display = 'none';
            clearInterval(splashInterval);
          }, 500);
        }
      };
      
      // Debug logging
      window.addEventListener('load', function() {
        console.log('✓ Page loaded');
        console.log('✓ Root element:', document.getElementById('root'));
        
        // Check for React after a delay
        setTimeout(function() {
          const root = document.getElementById('root');
          if (root && root.hasChildNodes()) {
            console.log('✓ React mounted successfully');
            window.hideSplashScreen();
          } else {
            console.error('✗ React did not mount! Root is empty.');
            document.getElementById('splash-status').textContent = 'Error: React failed to load';
            document.getElementById('splash-status').style.color = '#ff4444';
          }
        }, 3000);
      });
      
      // Error handling
      window.addEventListener('error', function(e) {
        console.error('✗ Error:', e.message, e.filename, e.lineno);
        const statusText = document.getElementById('splash-status');
        if (statusText) {
          statusText.textContent = 'Error: ' + e.message;
          statusText.style.color = '#ff4444';
        }
      });
    </script>
  </body>
</html>
